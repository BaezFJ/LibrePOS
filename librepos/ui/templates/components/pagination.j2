{#
    Pagination Component

    Renders pagination controls using MaterializeCSS styling.
    Works with Flask-SQLAlchemy Pagination objects.

    Usage:
        {% import "components/pagination.j2" as Pagination %}
        {{ Pagination.render(pagination, 'iam.users') }}
        {{ Pagination.render(pagination, 'iam.user_login_history', {'slug': user.slug}) }}
#}

{% macro render(pagination, endpoint, params={}) %}
{% if pagination.pages > 1 %}
<ul class="pagination center-align">
    {# Previous button #}
    <li class="{{ 'disabled' if not pagination.has_prev else 'waves-effect' }}">
        {% if pagination.has_prev %}
            <a href="{{ url_for(endpoint, page=pagination.prev_num, **params) }}">
                <i class="material-symbols-rounded">chevron_left</i>
            </a>
        {% else %}
            <a href="#!"><i class="material-symbols-rounded">chevron_left</i></a>
        {% endif %}
    </li>

    {# Page numbers with ellipsis #}
    {% for page_num in pagination.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
        {% if page_num %}
            <li class="{{ 'active' if page_num == pagination.page else 'waves-effect' }}">
                <a href="{{ url_for(endpoint, page=page_num, **params) }}">{{ page_num }}</a>
            </li>
        {% else %}
            <li class="disabled"><a href="#!">...</a></li>
        {% endif %}
    {% endfor %}

    {# Next button #}
    <li class="{{ 'disabled' if not pagination.has_next else 'waves-effect' }}">
        {% if pagination.has_next %}
            <a href="{{ url_for(endpoint, page=pagination.next_num, **params) }}">
                <i class="material-symbols-rounded">chevron_right</i>
            </a>
        {% else %}
            <a href="#!"><i class="material-symbols-rounded">chevron_right</i></a>
        {% endif %}
    </li>
</ul>

<p class="center-align grey-text" style="font-size: 0.9rem;">
    Showing {{ pagination.first }} - {{ pagination.last }} of {{ pagination.total }}
</p>
{% endif %}
{% endmacro %}
