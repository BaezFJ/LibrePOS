<!--
This template contains Jinja2 macros for fundamental UI building blocks and basic components.

Key responsibilities:
- Provides reusable atomic UI elements and basic components
- Defines core visual elements and controls
- Maintains consistent styling and behavior
- Ensures component interoperability and composition

Components include:
- Tables and data displays
- Icons and visual indicators
- Buttons and action controls
- Form elements and inputs
- Basic content elements
-->


<!--====================-->
<!-- TABLE COMPONENTS -->
<!--====================-->

{#
Table Documentation:

Parameters:
- headers: List of strings to be displayed as column headers
  The number of headers determines the number of columns in the table.
  Each header is rendered in a <th> element in the table header row.
  
- classes: Optional string of additional CSS classes
  Space-separated string of classes to be added to base table classes.
  Default is empty string.

Base classes:
- striped: Adds alternating row colors
- highlight: Adds hover highlighting to rows

The table content is provided via the caller() block
#}

{% macro table(headers, classes='') %}
    {% set base_class = "striped highlight " %}
    {% set set_table_classes = base_class + classes %}

    <table class="{{ set_table_classes }}">
        <thead>
        <tr>
            {% for header in headers %}
                <th>{{ header }}</th>
            {% endfor %}
        </tr>
        </thead>
        <tbody>
        {{ caller() }}
        </tbody>
    </table>
{% endmacro %}


<!--====================-->
<!-- ICON COMPONENTS -->
<!--====================-->

{#
Icon Documentation:

Parameters:
- icon: String representing the Material Symbols icon name to display
  The icon name must match a valid Material Symbols icon identifier.
  For available icons, see: https://fonts.google.com/icons

- classes: Optional string of additional CSS classes
  Space-separated string of classes to be added to base icon classes.
  Default is empty string.

Base classes:
- material-symbols-rounded: Applies Material Symbols rounded style variant

Example usage:
{{ render_icon("home") }}
{{ render_icon("settings", classes="large blue-text") }}
#}

{% macro render_icon(icon, classes='') %}
    {% set icon_style = "material-symbols-rounded " %}
    {% set icon_classes = icon_style + classes %}

    <i class="{{ icon_classes | trim }}">{{ icon }}</i>

{% endmacro %}

{#
Active Icon Documentation:

Parameters:
- data: Boolean value indicating the active/inactive state
  True renders a checked green icon indicating active state
  False renders an unchecked red icon indicating inactive state
  Default is True

Visual states:
- Active: Green filled radio button (radio_button_checked icon with success-text class)
- Inactive: Red empty radio button (radio_button_unchecked icon with danger-text class)

Uses render_icon macro internally to display Material Symbols icons with appropriate styling.

Example usage:
{{ render_active_icon() }}         -> Renders active green icon
{{ render_active_icon(False) }}    -> Renders inactive red icon
#}

{% macro render_active_icon(data=True) %}
    {% set active_color = "success-text" if data else "danger-text" %}
    {% set active_icon = "radio_button_checked" if data else "radio_button_unchecked" %}

    {{ render_icon(active_icon, classes=active_color) }}

{% endmacro %}


<!--====================-->
<!-- BUTTON COMPONENTS -->
<!--====================-->
{% set base_button_classes = "btn waves-effect waves-light rounded" %}

{#
Button Type Documentation:

button_type parameter accepts the following values:

- 'filled': Creates a solid button with full background color and contrasting text.
  Best for primary actions like "Save", "Submit", or "Continue".
  High visual emphasis draws user attention to the most important action.

- 'outlined': Creates a button with transparent background and colored border.
  Best for secondary actions like "Cancel", "Back", or alternative options.
  Medium visual emphasis provides clear action without competing with primary buttons.

- 'tonal': Creates a button with subtle background tint and no border.
  Best for tertiary actions or supporting functions like "Learn More", "Details".
  Low visual emphasis offers functionality without visual distraction.

- 'disabled': Creates a button that appears inactive and non-interactive.
  Used when an action is temporarily unavailable or conditions aren't met.
  Provides visual feedback that the action exists but cannot be performed.

Visual hierarchy: filled (highest emphasis) > outlined (medium) > tonal (lowest) > disabled (inactive)
#}

{% macro render_button(text, button_type, url='#', classes='', modal_id=None) %}
    {% set button_classes = base_button_classes + " " + button_type + " " + classes %}
    {% set button_url = "javascript:" + modal_id + ".showPopover()" if modal_id else url %}

    <a href="{{ button_url }}" class="{{ button_classes|trim }}">{{ text }}</a>

{% endmacro %}

{# 
Modal Button Documentation:

Parameters:
- text: String text to display on the button
  Label that appears on the button face.

- button_type: String indicating visual style variant
  Must be one of: 'filled', 'outlined', 'tonal', or 'disabled'
  See button_type documentation above for details.

- modal_id: String ID of the target modal element
  Must match the ID of an existing modal element.
  Used to link button click to modal display.

- classes: Optional string of additional CSS classes
  Space-separated string of classes to be added to base button classes.
  Default is empty string.

Features:
- Uses HTML5 popover API for modal targeting
- Inherits base button styling and waves effect
- Maintains consistent button hierarchy with other buttons
- Automatically handles modal show/hide behavior

Example usage:
{{ render_modal_button("Open Settings", "filled", "settingsModal") }}
{{ render_modal_button("Show Help", "tonal", "helpModal", "blue-text") }}
#}

{% macro render_modal_button(text, button_type, modal_id, classes='') %}
    {% set button_classes = base_button_classes + " " + button_type + " " + classes %}

    <button class="{{ button_classes|trim }}" popovertarget="{{ modal_id }}">{{ text }}</button>

{% endmacro %}


<!--=================-->
<!-- FORM COMPONENTS -->
<!--=================-->

{# 
Form Documentation:

Parameters:
- form: Form object to be rendered
  WTForms form instance containing the fields to display
  
- url: String URL for form submission
  Target endpoint for POST request when form is submitted

Layout:
- Renders in responsive grid layout
- Fields use col s12 m6 l4 xl3 classes for responsive sizing
- Submit button centered in full-width column

Features:
- Automatically includes CSRF token via form.hidden_tag()
- Styles submit button with filled, rounded button classes
- Renders all non-CSRF fields using render_field macro
- Input fields wrapped in materialize input-field class
#}

{% macro render_form(form, url) %}

    {% set responsive_class = "col s12 m6 l4 xl3" %}

    <form action="{{ url }}" method="post" class="row">
        {{ form.hidden_tag() }}
        {% for field in form if field.name != 'csrf_token' %}
            {% if field.name == "submit" %}
                <div class="col s12 center-block">
                    {{ field(class="btn filled rounded waves-effect waves-light") }}
                </div>
            {% else %}
                <div class="{{ responsive_class }} input-field">
                    {{ render_field(field) }}
                </div>
            {% endif %}
        {% endfor %}
    </form>

{% endmacro %}

{# 
Form Field Documentation:

Parameters:
- field: Form field object to be rendered
  WTForms field instance to display with appropriate styling and behavior
  Supports BooleanField and standard text input fields

Features:
- Automatically detects field type and uses appropriate render macro
- BooleanFields render as Material toggle switches
- Text fields include label and optional icon/supporting text
- Maintains consistent Material Design styling

Example usage:
{{ render_field(form.name) }}
{{ render_field(form.enabled) }}
#}

<!-- Form Field Components -->
{% macro render_field(field) %}

    {% if field.type == "BooleanField" %}
        {{ render_switch_field(field) }}
    {% else %}
        {{ render_text_field(field) }}
    {% endif %}

{% endmacro %}

{# 
Switch Field Documentation:

Parameters:
- field: Form field object of type BooleanField to be rendered
  WTForms BooleanField instance to display as a Material toggle switch
  Must be a BooleanField type for proper behavior

Layout:
- Renders as Material Design toggle switch component
- Label text displayed before the switch control
- Switch includes animated lever element for visual feedback

Features:
- Converts standard checkbox into Material toggle switch
- Maintains form field binding and validation
- Provides touch-friendly mobile interaction
- Animates state changes with sliding lever

Example usage:
{{ render_switch_field(form.enabled) }}
{{ render_switch_field(form.active_status) }}
#}

{% macro render_switch_field(field) %}
    <div class="switch">
        <span>{{ field.label.text }}&colon; &nbsp;</span>
        <label>
            {{ field(**kwargs)|safe }}
            <span class="lever"></span>
        </label>
    </div>
{% endmacro %}

{# 
Text Field Documentation:

Parameters:
- field: Form field object to be rendered
  WTForms field instance to display with appropriate styling and behavior
  Supports text inputs, textareas, password fields, and select fields

For text inputs:
- Renders standard text input with floating label
- Maintains Material Design input styling
- Supports placeholder text and validation states

For select fields:
- Renders as Material Design select dropdown
- Options populated from field.choices
- Maintains form field binding and validation
- Supports multiple selection if configured

Features:
- Automatically detects field type and applies appropriate styling
- Includes field label with proper positioning
- Preserves form validation and error states
- Compatible with Materialize CSS input styles

Example usage:
{{ render_text_field(form.name) }}         -> Renders text input
{{ render_text_field(form.category) }}     -> Renders select dropdown
#}

{% macro render_text_field(field) %}

    <!-- TODO 7/5/25 : Render form field error messages. -->

    {{ field(**kwargs)|safe }}
    {{ field.label }}

{% endmacro %}


<!--===================-->
<!-- NUMPAD COMPONENTS -->
<!--===================-->

{# 
Numpad Button Documentation:

Parameters:
- value: String or number to display on the button
  The text/number that appears on the button face and is input when clicked.
  Usually a single digit (0-9) for numeric input.

- input_id: String ID of the target input element
  ID of the input field that will receive the button's value.
  Used by onclick handler to append value to input.

Features:
- Renders as large Material Design button
- Uses base numpad-btn styling for consistent appearance
- Integrates with addToInput JavaScript function
- Maintains touch-friendly sizing for mobile use

Example usage:
{{ render_numpad_button("7", "amount_input") }}
{{ render_numpad_button("0", "pin_field") }}
#}

{% macro render_numpad_button(value, input_id) %}
    {% set base_class = "btn-large numpad-btn tonal" %}
    <button type="button" class="{{ base_class }}" onclick="addToInput(this, '{{ input_id }}')"
            value="{{ value }}">{{ value }}
    </button>
{% endmacro %}

{# 
Numpad Documentation:

Parameters:
- input_id: String ID of the target input element
  ID of the input field that will receive numpad input values.
  Used to link numpad buttons to the target input field.

Layout:
- Renders 4x3 grid of large touch-friendly buttons
- Digits 1-9 arranged in calculator layout
- Bottom row contains clear, 0, and submit buttons
- Uses Materialize responsive grid classes

Features:
- Clear button (X) resets input field
- Submit button (✓) triggers form submission
- Numeric buttons append value to input
- Fully responsive sizing for all devices
- Touch-optimized button spacing

Example usage:
{{ render_numpad("amount_field") }}
{{ render_numpad("pin_input") }}
#}

{% macro render_numpad(input_id) %}

    <!-- Numpad Grid -->
    <div class="row center-align mb-4">
        <!-- Row 1 -->
        <div class="col s4">
            {{ render_numpad_button("1", input_id) }}
        </div>
        <div class="col s4">
            {{ render_numpad_button("2", input_id) }}
        </div>
        <div class="col s4">
            {{ render_numpad_button("3", input_id) }}
        </div>

        <!-- Row 2 -->
        <div class="col s4">
            {{ render_numpad_button("4", input_id) }}
        </div>
        <div class="col s4">
            {{ render_numpad_button("5", input_id) }}
        </div>
        <div class="col s4">
            {{ render_numpad_button("6", input_id) }}
        </div>

        <!-- Row 3 -->
        <div class="col s4">
            {{ render_numpad_button("7", input_id) }}
        </div>
        <div class="col s4">
            {{ render_numpad_button("8", input_id) }}
        </div>
        <div class="col s4">
            {{ render_numpad_button("9", input_id) }}
        </div>

        <!-- Row 4 -->
        <div class="col s4">
            <button type="reset" class="btn-large danger">
                {{ render_icon("clear", classes="black-text") }}
            </button>
        </div>
        <div class="col s4">
            {{ render_numpad_button("0", input_id) }}
        </div>
        <div class="col s4">
            <button class="btn-large success" type="submit">
                {{ render_icon("check", classes="black-text") }}
            </button>
        </div>
    </div>

{% endmacro %}