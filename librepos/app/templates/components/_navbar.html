{#
    App Bar Component (M3)
    ==========================
    Center-aligned small app bar following Material Design 3 spec.

    Import:
        {% import "components/_navbar.html" as Navbar %}

    Basic Usage:
        {% call Navbar.render() %}
            {% call Navbar.leading() %}
                {{ Navbar.sidenav_trigger() }}
            {% endcall %}
            {{ Navbar.headline("Page Title") }}
            {% call Navbar.trailing() %}
                {{ Navbar.icon_button("apps", "Applications") }}
            {% endcall %}
        {% endcall %}

    Note: Requires Materialize sidenav initialization:
        M.Sidenav.init(document.querySelectorAll('.sidenav'));
#}

{% import "macros/icon.html" as Icon %}


{# render(center_aligned=True)
   ----------------------------
   Creates the app bar container.

   Parameters:
       center_aligned (bool): If True, centers the headline text. Defaults to True.

   Usage: Must be called with {% call %} to inject leading/headline/trailing sections.
#}
{% macro render(center_aligned=True) %}
    <div class="appbar{{ ' center-aligned' if center_aligned }}" role="banner">
        {{ caller() }}
    </div>
{% endmacro %}


{# leading()
   ---------
   Wraps leading icon buttons (sidenav trigger, back button).

   Usage: Must be called with {% call %} to inject icon buttons.
#}
{% macro leading() %}
    <div class="leading">
        {{ caller() }}
    </div>
{% endmacro %}


{# headline(text)
   ---------------
   Displays the page title as a centered headline.

   Parameters:
       text (str): Title text. Truncated to 15 characters.
#}
{% macro headline(text) %}
    <h1 class="headline">{{ text|truncate(15) }}</h1>
{% endmacro %}


{# trailing()
   ----------
   Wraps trailing icon buttons (actions, account).

   Usage: Must be called with {% call %} to inject icon buttons.
#}
{% macro trailing() %}
    <div class="trailing">
        {{ caller() }}
    </div>
{% endmacro %}


{# icon_button(icon, label, url="#", target=None, class_="")
   ----------------------------------------------------------
   Creates an accessible icon button for the app bar.

   Parameters:
       icon   (str): Material Symbols icon name.
       label  (str): Required. aria-label for accessibility.
       url    (str): Optional. Link destination. Defaults to "#".
       target (str): Optional. data-target for dropdown triggers.
       class_ (str): Optional. Additional CSS classes.
#}
{% macro icon_button(icon, label, url="#", target=None, class_="") %}
    <a href="{{ url }}"
       class="icon-button{{ ' ' ~ class_ if class_ }}{{ ' dropdown-trigger' if target }}"
       aria-label="{{ label }}"
       {{ 'data-target=' ~ target if target }}
       type="button">
        {{ Icon.render(icon) }}
    </a>
{% endmacro %}


{# sidenav_trigger(target="mainMenu")
   ------------------------------------
   Creates a hamburger menu icon button to toggle the sidenav.
   Hidden at md+ breakpoint (900px) via CSS.

   Parameters:
       target (str): Optional. ID of the sidenav to trigger. Defaults to "mainMenu".
#}
{% macro sidenav_trigger(target="mainMenu") %}
    <a href="#"
       data-target="{{ target }}"
       class="icon-button sidenav-trigger"
       aria-label="Open navigation menu"
       type="button">
        {{ Icon.menu() }}
    </a>
{% endmacro %}
