/*
 * LibrePOS Design System Variables
 * ================================
 * CSS custom properties following the --pos-* naming convention.
 * Dual theme support via data-theme attribute and prefers-color-scheme fallback.
 *
 * Usage:
 *   - Theme toggle: <html data-theme="dark"> or <html data-theme="light">
 *   - Auto-detect: Remove data-theme attribute to follow system preference
 *
 * References:
 *   - Full design system: docs/uiux.md
 */

/* =============================================================================
   BASE VARIABLES (Theme-Independent)
   ============================================================================= */
:root {
    /* ── Interaction State Control ── */
    --pos-hover-lightness-delta: 10%;
    --pos-active-lightness-delta: 15%;

    /* ── Brand Colors ── */
    --pos-primary: #2563eb;
    --pos-primary-hover: hsl(from var(--pos-primary) h s calc(l - var(--pos-hover-lightness-delta)));
    --pos-primary-active: hsl(from var(--pos-primary) h s calc(l - var(--pos-active-lightness-delta)));

    --pos-secondary: #64748b;
    --pos-secondary-hover: hsl(from var(--pos-secondary) h s calc(l - var(--pos-hover-lightness-delta)));
    --pos-secondary-active: hsl(from var(--pos-secondary) h s calc(l - var(--pos-active-lightness-delta)));

    --pos-accent: #10b981;
    --pos-accent-hover: hsl(from var(--pos-accent) h s calc(l - var(--pos-hover-lightness-delta)));
    --pos-accent-active: hsl(from var(--pos-accent) h s calc(l - var(--pos-active-lightness-delta)));

    /* ── Semantic Colors ── */
    --pos-success: #22c55e;
    --pos-success-hover: hsl(from var(--pos-success) h s calc(l - var(--pos-hover-lightness-delta)));
    --pos-success-active: hsl(from var(--pos-success) h s calc(l - var(--pos-active-lightness-delta)));

    --pos-warning: #f59e0b;
    --pos-warning-hover: hsl(from var(--pos-warning) h s calc(l - var(--pos-hover-lightness-delta)));
    --pos-warning-active: hsl(from var(--pos-warning) h s calc(l - var(--pos-active-lightness-delta)));

    --pos-danger: #ef4444;
    --pos-danger-hover: hsl(from var(--pos-danger) h s calc(l - var(--pos-hover-lightness-delta)));
    --pos-danger-active: hsl(from var(--pos-danger) h s calc(l - var(--pos-active-lightness-delta)));

    --pos-info: #3b82f6;
    --pos-info-hover: hsl(from var(--pos-info) h s calc(l - var(--pos-hover-lightness-delta)));
    --pos-info-active: hsl(from var(--pos-info) h s calc(l - var(--pos-active-lightness-delta)));


    /* ── Typography ── */
    --pos-font-family: system-ui, -apple-system, BlinkMacSystemFont,
                       'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
    --pos-font-mono: ui-monospace, 'SF Mono', Monaco, 'Cascadia Code', monospace;

    /* Font Sizes - Touch-optimized minimums */
    --pos-text-xs: 0.75rem;    /* 12px - minimum for labels */
    --pos-text-sm: 0.875rem;   /* 14px */
    --pos-text-base: 1rem;     /* 16px - body text minimum */
    --pos-text-lg: 1.125rem;   /* 18px */
    --pos-text-xl: 1.25rem;    /* 20px */
    --pos-text-2xl: 1.5rem;    /* 24px */
    --pos-text-3xl: 1.875rem;  /* 30px */
    --pos-text-4xl: 2.25rem;   /* 36px - large displays */

    /* ── Spacing Scale ── */
    --pos-space-1: 0.25rem;   /* 4px */
    --pos-space-2: 0.5rem;    /* 8px */
    --pos-space-3: 0.75rem;   /* 12px */
    --pos-space-4: 1rem;      /* 16px */
    --pos-space-5: 1.25rem;   /* 20px */
    --pos-space-6: 1.5rem;    /* 24px */
    --pos-space-8: 2rem;      /* 32px */
    --pos-space-10: 2.5rem;   /* 40px */
    --pos-space-12: 3rem;     /* 48px */

    /* ── Layout ── */
    --navbar-height: 64px;
    --navbar-height-mobile: 56px;
}


/* =============================================================================
   LIGHT THEME (Default)
   ============================================================================= */
:root,
:root:not([data-theme]),
[data-theme="light"] {
    color-scheme: light;

    /* ── Surface Colors ── */
    --pos-bg-primary: #ffffff;
    --pos-bg-secondary: #f8fafc;
    --pos-bg-tertiary: #f1f5f9;

    /* ── Text Colors ── */
    --pos-text-primary: #0f172a;
    --pos-text-secondary: #475569;
    --pos-text-muted: #94a3b8;

    /* ── Border & Dividers ── */
    --pos-border: #e2e8f0;
    --pos-border-strong: #cbd5e1;

    /* ── Shadow ── */
    --pos-shadow: rgba(15, 23, 42, 0.08);
    --pos-shadow-strong: rgba(15, 23, 42, 0.16);

    /* ── Semantic Container Colors ── */
    --pos-success-container: #dcfce7;
    --pos-warning-container: #fef3c7;
    --pos-danger-container: #fee2e2;
    --pos-info-container: #dbeafe;

    /* ══════════════════════════════════════════════════════════════════════════
       Material Design Token Mappings (Backwards Compatibility)
       ══════════════════════════════════════════════════════════════════════════ */
    --md-sys-color-primary: var(--pos-primary);
    --md-sys-color-on-primary: #ffffff;
    --md-sys-color-primary-container: #dbeafe;
    --md-sys-color-on-primary-container: #1e3a5f;

    --md-sys-color-secondary: var(--pos-secondary);
    --md-sys-color-on-secondary: #ffffff;
    --md-sys-color-secondary-container: #f1f5f9;
    --md-sys-color-on-secondary-container: #334155;

    --md-sys-color-tertiary: var(--pos-accent);
    --md-sys-color-on-tertiary: #ffffff;
    --md-sys-color-tertiary-container: #d1fae5;
    --md-sys-color-on-tertiary-container: #065f46;

    --md-sys-color-error: var(--pos-danger);
    --md-sys-color-on-error: #ffffff;
    --md-sys-color-error-container: var(--pos-danger-container);
    --md-sys-color-on-error-container: #991b1b;

    --md-sys-color-background: var(--pos-bg-secondary);
    --md-sys-color-on-background: var(--pos-text-primary);
    --md-sys-color-surface: var(--pos-bg-primary);
    --md-sys-color-on-surface: var(--pos-text-primary);

    --md-sys-color-surface-variant: var(--pos-bg-tertiary);
    --md-sys-color-on-surface-variant: var(--pos-text-secondary);

    --md-sys-color-outline: var(--pos-border-strong);
    --md-sys-color-outline-variant: var(--pos-border);

    --md-sys-color-inverse-surface: #1e293b;
    --md-sys-color-inverse-on-surface: #f8fafc;
    --md-sys-color-inverse-primary: #60a5fa;

    --md-sys-color-shadow: var(--pos-shadow);
    --md-sys-color-scrim: rgba(15, 23, 42, 0.5);
    --md-sys-color-surface-tint: var(--pos-primary);

    /* ── System Semantic Colors ── */
    --sys-color-info: var(--pos-info);
    --sys-color-on-info: #ffffff;
    --sys-color-success: var(--pos-success);
    --sys-color-on-success: #ffffff;
    --sys-color-warning: var(--pos-warning);
    --sys-color-on-warning: #ffffff;
    --sys-color-error: var(--pos-danger);
    --sys-color-on-error: #ffffff;
}


/* =============================================================================
   DARK THEME
   ============================================================================= */
[data-theme="dark"] {
    color-scheme: dark;

    /* ── Surface Colors ── */
    --pos-bg-primary: #0f172a;
    --pos-bg-secondary: #1e293b;
    --pos-bg-tertiary: #334155;

    /* ── Text Colors ── */
    --pos-text-primary: #f8fafc;
    --pos-text-secondary: #94a3b8;
    --pos-text-muted: #64748b;

    /* ── Border & Dividers ── */
    --pos-border: #334155;
    --pos-border-strong: #475569;

    /* ── Shadow ── */
    --pos-shadow: rgba(0, 0, 0, 0.3);
    --pos-shadow-strong: rgba(0, 0, 0, 0.5);

    /* ── Semantic Container Colors ── */
    --pos-success-container: #14532d;
    --pos-warning-container: #78350f;
    --pos-danger-container: #7f1d1d;
    --pos-info-container: #1e3a8a;

    /* ══════════════════════════════════════════════════════════════════════════
       Material Design Token Mappings (Backwards Compatibility)
       ══════════════════════════════════════════════════════════════════════════ */
    --md-sys-color-primary: #60a5fa;
    --md-sys-color-on-primary: #1e3a5f;
    --md-sys-color-primary-container: #1e3a8a;
    --md-sys-color-on-primary-container: #dbeafe;

    --md-sys-color-secondary: #94a3b8;
    --md-sys-color-on-secondary: #1e293b;
    --md-sys-color-secondary-container: #334155;
    --md-sys-color-on-secondary-container: #e2e8f0;

    --md-sys-color-tertiary: #34d399;
    --md-sys-color-on-tertiary: #064e3b;
    --md-sys-color-tertiary-container: #065f46;
    --md-sys-color-on-tertiary-container: #d1fae5;

    --md-sys-color-error: #fca5a5;
    --md-sys-color-on-error: #7f1d1d;
    --md-sys-color-error-container: var(--pos-danger-container);
    --md-sys-color-on-error-container: #fecaca;

    --md-sys-color-background: var(--pos-bg-secondary);
    --md-sys-color-on-background: var(--pos-text-primary);
    --md-sys-color-surface: var(--pos-bg-primary);
    --md-sys-color-on-surface: var(--pos-text-primary);

    --md-sys-color-surface-variant: var(--pos-bg-tertiary);
    --md-sys-color-on-surface-variant: var(--pos-text-secondary);

    --md-sys-color-outline: var(--pos-border-strong);
    --md-sys-color-outline-variant: var(--pos-border);

    --md-sys-color-inverse-surface: #f8fafc;
    --md-sys-color-inverse-on-surface: #1e293b;
    --md-sys-color-inverse-primary: #2563eb;

    --md-sys-color-shadow: var(--pos-shadow);
    --md-sys-color-scrim: rgba(0, 0, 0, 0.6);
    --md-sys-color-surface-tint: #60a5fa;

    /* ── System Semantic Colors ── */
    --sys-color-info: #60a5fa;
    --sys-color-on-info: #1e3a8a;
    --sys-color-success: #4ade80;
    --sys-color-on-success: #14532d;
    --sys-color-warning: #fbbf24;
    --sys-color-on-warning: #78350f;
    --sys-color-error: #fca5a5;
    --sys-color-on-error: #7f1d1d;
}


/* =============================================================================
   SYSTEM PREFERENCE FALLBACK
   Applies when no data-theme attribute is set
   ============================================================================= */
@media (prefers-color-scheme: dark) {
    :root:not([data-theme]) {
        color-scheme: dark;

        /* ── Surface Colors ── */
        --pos-bg-primary: #0f172a;
        --pos-bg-secondary: #1e293b;
        --pos-bg-tertiary: #334155;

        /* ── Text Colors ── */
        --pos-text-primary: #f8fafc;
        --pos-text-secondary: #94a3b8;
        --pos-text-muted: #64748b;

        /* ── Border & Dividers ── */
        --pos-border: #334155;
        --pos-border-strong: #475569;

        /* ── Shadow ── */
        --pos-shadow: rgba(0, 0, 0, 0.3);
        --pos-shadow-strong: rgba(0, 0, 0, 0.5);

        /* ── Semantic Container Colors ── */
        --pos-success-container: #14532d;
        --pos-warning-container: #78350f;
        --pos-danger-container: #7f1d1d;
        --pos-info-container: #1e3a8a;

        /* ── Material Design Token Mappings ── */
        --md-sys-color-primary: #60a5fa;
        --md-sys-color-on-primary: #1e3a5f;
        --md-sys-color-primary-container: #1e3a8a;
        --md-sys-color-on-primary-container: #dbeafe;

        --md-sys-color-secondary: #94a3b8;
        --md-sys-color-on-secondary: #1e293b;
        --md-sys-color-secondary-container: #334155;
        --md-sys-color-on-secondary-container: #e2e8f0;

        --md-sys-color-tertiary: #34d399;
        --md-sys-color-on-tertiary: #064e3b;
        --md-sys-color-tertiary-container: #065f46;
        --md-sys-color-on-tertiary-container: #d1fae5;

        --md-sys-color-error: #fca5a5;
        --md-sys-color-on-error: #7f1d1d;
        --md-sys-color-error-container: var(--pos-danger-container);
        --md-sys-color-on-error-container: #fecaca;

        --md-sys-color-background: var(--pos-bg-secondary);
        --md-sys-color-on-background: var(--pos-text-primary);
        --md-sys-color-surface: var(--pos-bg-primary);
        --md-sys-color-on-surface: var(--pos-text-primary);

        --md-sys-color-surface-variant: var(--pos-bg-tertiary);
        --md-sys-color-on-surface-variant: var(--pos-text-secondary);

        --md-sys-color-outline: var(--pos-border-strong);
        --md-sys-color-outline-variant: var(--pos-border);

        --md-sys-color-inverse-surface: #f8fafc;
        --md-sys-color-inverse-on-surface: #1e293b;
        --md-sys-color-inverse-primary: #2563eb;

        --md-sys-color-shadow: var(--pos-shadow);
        --md-sys-color-scrim: rgba(0, 0, 0, 0.6);
        --md-sys-color-surface-tint: #60a5fa;

        /* ── System Semantic Colors ── */
        --sys-color-info: #60a5fa;
        --sys-color-on-info: #1e3a8a;
        --sys-color-success: #4ade80;
        --sys-color-on-success: #14532d;
        --sys-color-warning: #fbbf24;
        --sys-color-on-warning: #78350f;
        --sys-color-error: #fca5a5;
        --sys-color-on-error: #7f1d1d;
    }
}


/* =============================================================================
   HTMX Loading States
   ============================================================================= */
.htmx-indicator {
    display: none;
}

.htmx-request .htmx-indicator {
    display: block;
}

.htmx-request table,
.htmx-request .collection {
    opacity: 0.5;
    pointer-events: none;
    transition: opacity 0.2s ease;
}
